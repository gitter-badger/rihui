# iframe 加载托管表单方式

## 请求 getHostedPaymentPageRequest ，获取 token 。

url:[getHostedPaymentPageRequest](http://developer.authorize.net/api/reference/index.html#payment-transactions-get-an-accept-payment-page)

请求该URL，可以指定加载表单的样式等各种参数，具体参考：[Accept Hosted feature details page](http://developer.authorize.net/api/reference/features/accept_hosted.html)

### 如有必要，需要先获取用户的信息，回填form表单

## 使用上面获取的token，初始化form表单。

```html
<form id="send_hptoken" action="https://test.authorize.net/payment/payment" method="post" target="load_payment" >
    <input type="hidden" name="token" value="<?php echo $token ?>" />
    <button type="submit">pay</button>
</form>

<iframe id="load_payment" class="embed-responsive-item" name="load_payment" width="100%" height="650px" frameborder="0" scrolling="no">
</iframe>
```

## 提交上一步的表单，会加载authorizenet的表单到iframe

当新用户还不存在Customer时处理： （决定是否需要单独页面为用户创建authorizenet的customer）

直接发起支付，BillTo 信息设置为空，看是否会创建 CustomerId 。

支付完成后看是否会返回CustomerId(如果返回，查看设置和不设置)

调试支付返回页面和返回页面设置 。